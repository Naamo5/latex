\providecommand{\main}{..}

\documentclass[/home/francois/latex/report/main.tex]{subfiles}

\begin{document}

\chapter{Experimental results}
\label{chapter:results}

This chapter presents the evaluation of the approaches developed. First, the outcomes of the signal filters are depicted, secondly, the performance of the calibration process is outlined, finally, results of the rigid and Rotational Mass Spring Damper (RMSD) models are compared as well as the Least-Squares (LS) and Recursive Total Least-Squares (RTLS) estimation methods.

\section{Signals pre-processing}
\label{section:results:pre-processing}

The performance of the filters is compared with non-filtered signals (Force/Torque (FT) measurements and orientation of the Tool Center Point (TCP)) and with a basic incremental derivation.

\subsection{\textsc{Euler}'s angles continuity filter}

\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.22]{\main/figures/maria_orientation_quat_conv.pdf}
    \caption{The orientation is converted to quaternion, then to a rotation matrix and back to \textsc{Euler} angles to ensure the unicity of the triplet. The dashed curves are the raw signals and the solid are signal filtered by quaternion conversion.}
  \label{fig:results:quat-conv}
\end{figure}

\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.22]{\main/figures/maria_orientation_filtered.pdf}
  \caption{The continuity of the orientation signal is ensured by the filtering with the Algorithm \ref{alg:method:continuity}. The dashed curves are the orientation after quaternion conversion and the solid are the final output of the filter.}
  \label{fig:results:orientation-filtered}
\end{figure}

The orientation of the \ac{TCP} output by the robot is converted to quaternion and then back to \textsc{Euler} angles (cf. Subsection \ref{subsection:method:euler-filter}). The output of the quaternion filter is depicted in figure \ref{fig:results:quat-conv}. For instance, at $t = 0.0 \ \si{\second}$, the raw orientation is $\Theta_{raw} = (2.2, 2.3, 0.0)$ and the filter converts to  $\Theta_{quat} = (3.14, 0.0, 1.6)$ which is more readable for a human being.

As it can be noticed in the figure \ref{fig:results:quat-conv}, the orientation is not continuous and jump form $-\pi$ to $\pi$. Therefore, the continuity algoritm (cf. Algorithm \ref{alg:method:continuity}) is applied and the filtered signal is shown in the figure \ref{fig:results:orientation-filtered}.

\subsection{\textsc{Savitzky–Golay} filter}

The output of the \textsc{Savitzky–Golay} filter for the derivation of the linear speed and angular acceleration are presented hereafter. The comparison is made with a classical iterative derivation ($f'(t) \approx  [f(t+\delta) - f(t)] / \delta$). The filter avoids the huge spikes generated by the measurement noise. Ultimately, it behaves analogously to a low-pass filter.

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.21]{\main/figures/maria_linear_speed.pdf}
  \caption{First derivative of the position of the \ac{TCP} derived with a \textsc{Savitzky–Golay} filter. The filter works with a window of size 19 ($\approx 0.13 \ \si{\second}$) and a polynomial of degree 3.}
  \label{fig:results:linear-speed-filtered}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.21]{\main/figures/maria_angular_acceleration.pdf}
  \caption{Second derivative of the orientation of the \ac{TCP} derived with a \textsc{Savitzky–Golay} filter. The filter works with a window of size 45 ($\approx 0.3 \ \si{\second}$) and a polynomial of degree 4.}
  \label{fig:results:angular-acceleration-filtered}
\end{figure}


\subsection{Low-pass filter}

The \ac{FT} signals is filtered with a \textsc{Butterworth} low-pass filter. The noise has two characteristics: its frequency is around $50 \ \si{\hertz}$ and its amplitude increases consequently when the signal varies. The output of the filter for torque signals is depicted in figure \ref{fig:results:torque}. The filtered signals show less noise. Also, the time characteristics of variation of the signal (torque in figure \ref{fig:results:torque}) is conform with the time characteristics of the dynamics of the robot (angular acceleration in \ref{fig:results:torque}). As a reminder, the torque is equivalent to the angular acceleration multiply by a constant, thus their characteristics should be similar.

\begin{figure}[ht!]
  \centering
  \includegraphics[scale=0.21]{\main/figures/maria_torque.pdf}
  \caption{Torque acting on the tool measured by a Gamma \ac{FT} sensor. The  filter applied is a \textsc{Butterworth} low-pass filter of degree 8 with a cut of frequency of $18 \ \si{\hertz}$. The filter is applied two times –forward and backward– to have a zero phase output. Consequently the cut of frequency is $36 \ \si{\hertz}$. \label{fig:results:force-torque}}
  \label{fig:results:torque}
\end{figure}

\clearpage

\section{Calibration of the gripper}
\label{section:results:calibration}

\subsection{Inertial parameters of the tool}

As mentioned in the chapter \ref{chapter:method}, the inertial parameters of the tool are estimated using the rigid model defined in section \ref{section:background:rigid}. The calibration is tested on the robot depicted in figure \ref{fig:background:stanislaw}. From the equation of torque, the parameters are optimized such that the estimated torque signals fit the measured ones. The output of the calibration is presented in table \ref{tab:results:calibration-tool}.

The calibration of the mass is not as precise as the accuracy of the \ac{FT} sensor (cf. Table \ref{tab:background:ft-sensor}). It would be better to estimate the mass separately. It is possible to measure the force with the tool upside down (the \ac{FT} sensor at the bottom) and compute the difference with the standing position. Then the mass line in the matrix equation of the rigid model (cf. equation \ref{eq:appendix:rigid}) could be merely removed. The estimation of the center of mass and the inertia are satisfactory considering that the ground-truth values are hard to measure.

\begin{table}[h]
  \begin{center}
    \renewcommand{\arraystretch}{1.2} % Default value: 1
    \begin{tabular}{l|c|c} % <-- Alignments: 1st column left, 2nd middle and 3rd right, with vertical lines in between
      \textbf{Parameters} & \textbf{Estimated value} & \textbf{Measured value}\\
      \hline
      Mass ($\si{\kilogram}$)  & 0.492 & 0.505 \\
      \hline
      Center of mass $c_x$ ($\si{\meter}$)  & 0.001 & 0.0 \\
      \hline
      Center of mass $c_y$ ($\si{\meter}$)  & 0.0003 & 0.0 \\
      \hline
      Center of mass $c_y$ ($\si{\meter}$)  & 0.181 & 0.19 \\
      \hline
      Inertia $I_{xx}$ ($\si{\kilogram\meter\squared}$)  & $8.7 \times 10^{-4}$ & $5.8 \times 10^{-4}$ \\
      \hline
      Inertia $I_{xy}$ ($\si{\kilogram\meter\squared}$)  & $2.3 \times 10^{-5}$ & 0.0 \\
      \hline
      Inertia $I_{xz}$ ($\si{\kilogram\meter\squared}$)  & $1.8 \times 10^{-5}$ & 0.0 \\
      \hline
      Inertia $I_{yy}$ ($\si{\kilogram\meter\squared}$)  & $5.3 \times 10^{-4}$ & $5.8 \times 10^{-4}$ \\
      \hline
      Inertia $I_{yz}$ ($\si{\kilogram\meter\squared}$)  & $1.1 \times 10^{-5}$ & 0.0 \\
      \hline
      Inertia $I_{zz}$ ($\si{\kilogram\meter\squared}$)  & 0.0017 & 0.001 \\
      \hline
    \end{tabular}
  \end{center}
  \caption{Comparison between the estimated and measured inertial parameters of the tool.\label{tab:results:calibration-tool}}
\end{table}

To confirm the soundness of the calibration, the estimated torque and the measured torque are compared in figures \ref{fig:results:torque-x}, \ref{fig:results:torque-y} and \ref{fig:results:torque-z}.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.29]{\main/figures/load_free_torque_x_comparison.pdf}
  \caption{Comparison of the estimated and measured torque about $x$-axis for the calibration of the inertial tool parameters.}
  \label{fig:results:torque-x}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.29]{\main/figures/load_free_torque_y_comparison.pdf}
  \caption{Comparison of the estimated and measured torque about $y$-axis for the calibration of the inertial tool parameters.}
  \label{fig:results:torque-y}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.29]{\main/figures/load_free_torque_z_comparison.pdf}
  \caption{Comparison of the estimated and measured torque the $z$-axis for the calibration of the inertial tool parameters.}
  \label{fig:results:torque-z}
\end{figure}

The comparison test is positive, the estimated torques approximately match the measured signals. Of course, it is not perfect but steady states are reached with similar values, the characteristic time of oscillation are similar even if the amplitudes are not the same. After $t = 7.0 \si{\second}$, unlike the measured signal, the estimated torque about the $z$-axis is constant (cf. Figure \ref{fig:results:torque-z}). This may be explained by the fact that the model does not consider the geometry of the \textit{tool-sensor} link. Some side effects can therefore appear.

\subsection{Spring constant and damper coefficient}

Once the tool parameters have been calibrated, the \ac{RMSD} model comes into play to estimate the vacuum cup properties. The equation of the torque from Fondamental Principle of Dynamics (FPD) applied to the tool \{1\} and the item \{2\} are combined to optimize the two parameters. The vacuum gripper grasped the standard item described in section \ref{subsection:setup:calibration:tool} right in the middle of a face. The inertial properties of the item are entered in the model, as well as the distance between the \ac{TCP} and the center of mass of the item. The larger dimension of the standard box is lined up with $\overrightarrow{x_0}$. First, the robot arm moves horizontally along the $y$-axis. From that kinetic data, $k$ and $\lambda$ are estimated (cf. table \ref{tab:results:calibration-cup}). The comparison of the modeled and measured torque is presented in figure \ref{fig:results:calibration:suction-torque-x}.

\begin{table}[h]
  \begin{center}
    \renewcommand{\arraystretch}{1.2} % Default value: 1
    \begin{tabular}{l|c} % <-- Alignments: 1st column left, 2nd middle and 3rd right, with vertical lines in between
      \textbf{Parameters} & \textbf{Estimated value} \\
      \hline
      Spring constant $k$ ($\si{\newton\meter\per\radian}$) & 0.016\\
      \hline
      Damper coefficient $\lambda$ ($\si{\newton\meter\second\per\radian}$) & 0.041 \\
      \hline
    \end{tabular}
  \end{center}
  \caption{Comparison between the estimated and measured inertial parameters of the tool.\label{tab:results:calibration-cup}}
\end{table}

\begin{figure}
  \centering
    \includegraphics[scale=0.29]{\main/figures/calib_torque_x.pdf}
  \caption{Comparison of the estimated and measured torque over the $x$-axis for the calibration of the suction cup properties.}
  \label{fig:results:calibration:suction-torque-x}
\end{figure}

With no theoretical values to compare the results, the robot executes a similar motion about the $x$-axis with the same configuration. The larger dimension of the iPad box is still lined up the $\overrightarrow{x_0}$. This explains why the amplitude of oscillation is smaller. The estimated torque is compared with the measured one (cf. Figure \ref{fig:results:calibration:suction-torque-y})in order to validate the abovementioned results.

\begin{figure}
  \centering
  \includegraphics[scale=0.29]{\main/figures/calib_torque_y.pdf}
  \caption{Validation of the estimated and measured torque over the $y$-axis.}
  \label{fig:results:calibration:suction-torque-y}
\end{figure}

The estimated torque does not perfectly fit the curve in figure \ref{fig:results:calibration:suction-torque-x} and \ref{fig:results:calibration:suction-torque-y}. There is probably a tradeoff in the optimization between the period of oscillation and amplitude. The \ac{LS} methods are likely to favor a model that fits the frequency of the output rather than the amplitude. Indeed, if the amplitude is perfectly fitted but the period is slightly different, the least-squares differences are significant when the estimated signal shifts with time due to the unsynchronization.

Figure \ref{fig:results:calibration:angle} shows the orientation of the item about the main frame. The frame of the item and the tool are meant to be aligned when picking. That is why the initial angle is $\pi$.

\begin{figure}
  \centering
  \includegraphics[scale=0.29]{\main/figures/angle_x.pdf}
  \caption{Orientation of the item in the frame \{0\} about the $x$-axis. From comparison with observation, the order of magnitude seems correct.}
  \label{fig:results:calibration:angle}
\end{figure}

\section{Least-Squares method and rigid model}

\subsection{Cart to box setup}

In a first attempt at estimating the mass of the item, the framework is tested with the item set listed in table \ref{tab:setup:items}. For each run, the mass is estimated between the moment the item is grasped to the moment it goes out of the volume above the source cart with the rigid model. Two methods are compared in this evaluation: the \textsc{Scipy} \texttt{scipy.optimize.least\_squares} based on the Trust Region reFlective (TRF) algorithm and the Singular Value Decomposition (SVD) algorithm (cf. \ref{subsection:ls}). Since the mass of an \ac{SKU} can differ due to product modification or discount, the ground-truth mass is estimated while the item is standing still during the measurement process. In this way, the estimated mass can be compared to the measured one.

\begin{figure}
  \centering
  \includegraphics[scale=0.3, angle=-90]{\main/figures/all_sku.pdf}
  \caption{Histograms and estimated normal distributions of the estimated mass of the item set via \ac{TRF} (ordinary) and \ac{SVD} method. The black bell curve is the normal distribution of the standstill measurement of the ground-truth value. The \ac{SVD} shows better result for lighter items.}
  \label{fig:results:rigid-ls}
\end{figure}

The average absolute error with the \ac{TRF} method for the whole item set is $0.0154 \ \si{\kilogram}$ and $0.0104 \ \si{\kilogram}$ for the \ac{SVD}. The average standard deviation is $0.0143 \ \si{\kilogram\squared}$ for the first and $0.0149 \ \si{\kilogram\squared}$ for the second. In this specific case, the \ac{SVD} algorithm performs better for a similar computation time.

One can notice, the estimated normal distribution of the standstill measurements and the thesis procedure ones are very close together. Therefore, the performance of the system is almost at the same level as the standstill measurement. Also, in the specific case of single-\ac{SKU} picking, the precision of the outputs is high enough to detect if the robot picks two items. As a matter of fact, over $\approx 0.100 \ \si{\kilogram}$, the process can detect such hard failures, as the bell curve of a double-pick item does not overlap the curve bell of a single-pick.

At this point in the project, the performance has been considered high enough for this particular case of \textit{pick-and-place}. The following evaluations are therefore done on the robot of the figure \ref{fig:background:stanislaw}. As explained in the abovementioned section, the robot pick from a tote and place in a tote. The trajectories are shorter, the robot is faster and does not offer a large time-window to record the data (cf. \ref{tab:results:comparison-robot}).

\begin{table}[h]
  \begin{center}
    \renewcommand{\arraystretch}{1.2} % Default value: 1
    \begin{tabular}{l|c|c|c} % <-- Alignments: 1st column left, 2nd middle and 3rd right, with vertical lines in between
      \textbf{Tasks} & \textbf{Trajectory ($\si{\meter}$)} & \textbf{Time-window ($\si{\second}$)} & \textbf{Speed ($\si{\meter\per\second}$)} \\
      \hline
      Cart to box & $\sim 2$ & $\sim 2$ & $\sim 2$ \\
      \hline
      Tote to tote & $\sim 0.5$ & $\sim 0.5$ & $\sim 4$ \\
      \hline
    \end{tabular}
  \end{center}
  \caption{Comparison between two different \textit{pick-and-place} scenarios.\label{tab:results:comparison-robot}}
\end{table}

\subsection{Tote to tote setup}
\label{results:tote}

As it is very time consumming to run \textit{pick-and-place} cycles for a dozen of different \ac{SKU}, a box of $0.480 \ \si{\kilogram}$ has been chosen for the \textit{tote-to-tote} configuration. The estimation setup is the same as for the previous test. Results are depicted in the figure \ref{fig:results:rigid-ls-tote}. The \ac{SVD} and \ac{TRF} method appears to perform almost the same. The average absolute error is above $0.200 \ \si{\kilogram}$ for both and the standard deviation $0.150 \ \si{\kilogram\squared}$ for the first and $0.134 \ \si{\kilogram\squared}$ for the second. The significant difference in performance is due to that the speed is higher and the recording duration shorter (cf. Table \ref{tab:results:comparison-robot}).

\begin{figure}
  \centering
  \includegraphics[scale=0.22, angle=0]{\main/figures/totes_ipad.pdf}
  \caption{Histograms and estimated normal distributions of the estimated mass of $0.480 \ \si{\kilogram}$ boxes with the tote to tote usecase (502 cycles). In blue, the \ac{TRF} algorithm, in orange, the \ac{SVD} method.}
  \label{fig:results:rigid-ls-tote}
\end{figure}

\section{\ac{RTLS} method and \ac{RMSD} model}

An evaluation with the \ac{RMSD} model with \ac{TRF} and the \ac{RTLS} algorithm is conducted with 500 picks of the same box (cf. Section \ref{results:tote}). As it can be seen on the figure \ref{fig:results:rmsd-rtls-tote}, the \ac{RMSD} model provide a better precision (the average absolute error is $0.111 \ \si{\kilogram}$) and enhance the accuracy (with a standard deviation of $0.095 \ \si{\kilogram\squared}$). Considering the error with the \ac{RTLS} method, the average absolute error is lower with $0.063 \si{\kilogram}$ and the output is more grouped as the standard deviation is $0.040 \ \si{\kilogram\squared}$.

\begin{figure}
  \centering
  \includegraphics[scale=0.22, angle=0]{\main/figures/totes_rtls.pdf}
  \caption{Histograms and estimated normal distributions of the estimated mass of $0.480 \ \si{\kilogram}$ boxes with the tote to tote usecase (457 cycles). The mass is estimated with a \ac{RMSD} model fitted with \ac{TRF} (in orange) and \ac{RTLS} (in blue) methods.}
  \label{fig:results:rmsd-rtls-tote}
\end{figure}

Considering the bell curve, the precision of the whole process should be sufficient to detect the \textit{two-items-grasped} hard failure introduced above. The performance is insufficient to use the mass as a feature for item detection as the accuracy and precision are very low. It might be used as a validation step but it is not a valuable asset for \ac{CNN}.

Thus, there is still plenty of scope for further development. Several weak points of the method have been spotted. First, the data recording may sometimes start when the item is still touching another one in the tote or oscillating. In the model, the initial condition for the orientation of the item is the same as the tool with no speed. The method can be improved by detecting the best moment to start caching the signals. Secondly, the computation of the orientation of the item is done with a \textsc{Matlab} script using \textsc{Simulink} and called with a \textsc{Python2Matlab} engine. This is not cost-effective and time-efficient at all. Thirdly, the framework does not output any indications about the confidence interval. A solution would be to use a \ac{RGTLS} with \ac{NCE}. On the one hand, it could improve the performance of the curve fitting step by better estimating the error. On the second hand, it could output a reliability factor base on the \ac{NCE}.

\section{Sustainability, ethics and societal aspects}

As I have demonstrated in the introduction (cf. chapter \ref{chapter:introduction}), automation is a boon to the \textit{e-commerce} market. Increasing the number of robots that can work 24 hours a day, 7 days a week with constant performance, decreasing the number of employees saves a lot of costs. The challenge of that industry is to build adaptive systems that can handle a wide range of products with a low error rate. Thus, the ability to estimate the mass of the payload of \textit{pick-and-place} system is a great step toward autonomy and versatility. Besides, \ac{FT} sensors are quite often already installed on robotics manipulators. The cost of implementation can be reduced to the cost of the development of an estimation software application. The method I have developed might be therefore economically profitable.

The automation of processes raises the question of the ever-growing numbers of endangered jobs, the standardization of methods and the loss of human values in product manufacturing. It is a broad topic and the question of whether robots should be incorporated into our life is not the topic of the report and involves theoretical expertise that cannot be presented in a thesis report. I can only provide a very superficial overview of the matter. It can be argued that while it is true that robots are replacing low-skilled workers and automating the tasks that they perform, robots and automation are requiring jobs that focus workers on higher-value work. For example, in order fulfillment warehouses, robots can perform menial tasks such as sorting, transporting and stocking, packaging, while higher-skilled roles such as quality-related tasks, which humans are more suitable for, can be completed by higher-skilled workers. Also, one may wonder if this argument is sustainable: what if the quality of higher-skilled roles can be processed by a robot? \textsc{Sandler} \textit{et al.} and \textsc{Poel} \textit{et al.} develop more conscientiously this topic in \cite{Sandler2014, Poel2011}. The sustainability or the level ethic of new technologies has to be analyzed by considering different theories (utilitarianism, ethics of duty or of value) and cannot be summarized in the few lines of this report.

Automation of order processing systems may give more access to goods to more people especially for those that have limited mobility or accessibility to shops or physical places. In contrast, phenomenon as \textit{Black Friday}, product destruction is many industries are boosted by \textit{e-commerce} companies. Accessibility is also a vehicle of hyper-consumerism and wild open business. Like many other technologies, industrial automation should be designed with a great reflection on the "what if" scenarios. And as a general rule, the development should not be only governed by economic perspectives but also by environmental and societal regards which are the backbones of sustainable development.

\end{document}
